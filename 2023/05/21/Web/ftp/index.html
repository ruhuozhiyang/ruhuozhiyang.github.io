<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="UTF-8">
    
    <link rel="apple-touch-icon" sizes="76x76" href="/null">
    <link rel="icon" type="image/png" href="/null">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    <title>FTP 手册 - young&#39;s personal tech manuals</title>
    
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    
    
    <meta name="description" content="">
    <meta name="author" content="young">
    <meta name="keywords" content="">
    <meta property="og:title" content="FTP 手册"/>
    <style>


    
    :root{
        --shadow-color: rgba(0,0,0,0.2);
        --sec-shadow: rgba(0,0,0,0.03);
        --shadow-hover-color: rgba(0,0,0,0.28);
        --first-text-color: #475b6d;
        --second-text-color: #37475b;
        --third-text-color: #858585;
        --default-text-color: #505050;
        --default-link-color: #007bff;
        --link-color: #000000;
        --second-link-color: #4F9BFA;
        --code-color:rgba(27,31,35,.05);
        --post-bkg-color: #fff;
        --page-bkg-color: #f2f5f8;
        --nav-a-hover-color: #3498db;
        --post-sec-text-color: #718096;
        --sec-bkg: #f2f5f8;
        --color-mode: 'light';
        --bkg-h: rgba(255,255,255,0.6);
        --bkg-m: #e1e4e8;
        --home-title-color: #4169E1;
        --shadow: 0 4px 10px rgba(0,2,4,0.06),0 0 1px rgba(0,2,4,0.11);
        --hr-color: #ddd;
        --bg-t: #f4f4f4;
        --nav-bkg: rgba(255,255,255,0.6);
    }

@media (prefers-color-scheme: dark) {
  :root {
    --color-mode: 'dark';
  }

  :root:not([data-theme]) {
    --first-text-color: hsla(0,0%,100%,0.92);
    --second-text-color: hsla(0,0%,100%,0.86);
    --third-text-color: #a7a9ad;
    --default-text-color: #505050;
    --default-link-color: #1589e9;
    --link-color: #000000;
    --second-link-color: #30a9de;
    --post-bkg-color: #252d38;
    --page-bkg-color: #181c27;
    --nav-a-hover-color: #3498db;
    --post-sec-text-color: #a7a9ad;
    --sec-bkg: #364151;
    --bkg-h: rgba(255,255,255,0.2);
    --bkg-m: rgba(255,255,255,0.1);
    --home-title-color: rgb(226, 82, 90);
    --code-color:#3e4b5e;
    --shadow: none;
    --hr-color: #718096;
    --bg-t: #364151;
    --nav-bkg: rgba(13,17,23,0.6);
  }
}

[data-theme='dark'] {
    --shadow-color: rgba(0,0,0,0.2);
    --shadow-hover-color: rgba(0,0,0,0.28);
    --first-text-color: hsla(0,0%,100%,0.92);
    --second-text-color: hsla(0,0%,100%,0.86);
    --third-text-color: #a7a9ad;
    --default-text-color: #505050;
    --default-link-color: #1589e9;
    --link-color: #000000;
    --second-link-color: #30a9de;
    --post-bkg-color: #252d38;
    --page-bkg-color: #181c27;
    --nav-a-hover-color: #3498db;
    --post-sec-text-color: #a7a9ad;
    --sec-bkg: #364151;
    --bkg-h: rgba(255,255,255,0.2);
    --bkg-m: rgba(255,255,255,0.1);
    --home-title-color: rgb(226, 82, 90);
    --code-color:#3e4b5e;
    --shadow: none;
    --hr-color: #718096;
    --bg-t: #364151;
    --nav-bkg: rgba(13,17,23,0.6);
}

</style>



<style>
#page-main,footer,.p-btn {
    display: none;
}
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
}
body {
    background-color: var(--page-bkg-color);
    color: var(--second-text-color);
    overflow-y: scroll;
    overflow-x: hidden;
    transition: all .3s;
}
a {
    color: var(--default-link-color);
    text-decoration: none;
    background-color: transparent;
}
a:hover{
    color: var(--second-link-color);
}
.main-content,.post-card-main{
    margin: 30px;
}



@media (max-width: 410px){
    .post-card-main{
        max-width: 350px!important;
    }
}

@media (max-width: 980px){
    .post-card-main{
        max-width: 520px!important;
    }
}


@media (min-width: 780px){ 
    h3{
        font-size: 1.5rem;
        line-height: 1.5em;
    }
}
@media (min-width: 1280px){ 
    h3{
        font-size: 1.7rem;
        line-height: 1.5em;
    }
}
@media (min-width: 2096px){ 
    h3{
        font-size: 1.8rem;
        line-height: 1.5em;
    }
}

.text-center{
    text-align: center!important;
}
.middle-center{
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
    -ms-flex-align: center;
    align-items: center;
    -webkit-box-pack: center;
    -ms-flex-pack: center;
    justify-content: center;
    height: 100%;
}
header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: fixed;
    height: 54px;
    padding: 0 1.25rem;
    top: 0;
    left: 0;
    right: 0;
    z-index: 10;
    border-bottom: 1px solid var(--bkg-m);
    background-color: var(--nav-bkg);
    backdrop-filter: blur(4px);
    transition: all .3s;
}
header .header__left, header .header__right {
    display: flex;
    align-items: center;
    font-family: rubik,sans-serif,Varela Round;
}
header .header__left .logo__text {
    font-size: 18px;
    font-weight: 450;
    padding: 14.5px 10px;
    border-radius: 5px;
    color: var(--second-text-color);
}
header .header__right .navbar__menus {
    height: 54px;
    padding: 0 0 0 15px;
}
header .header__right .button {
    color: var(--second-text-color);
}
header .header__right .navbar__menus .navbar-menu {
    display: inline-block;
    align-items: center;
    height: 54px;
    padding: 0 10px;
    font-size: 16px;
    line-height: 54px;
}
header .header__right .dropdown-icon {
    display: none;
    height: 54px;
    padding: 15px 10px;
    border: 0;
    background-color: transparent;
}
header .header__right .dropdown-menus {
    line-height: 2rem;
    animation: slide-in .15s ease 1;
    display: none;
    position: absolute;
    left: 12px;
    right: 12px;
    top: calc(54px + 10px);
    border-radius: 6px;
    padding: 24px;
    background-color: var(--page-bkg-color);
    border: 1px solid var(--bkg-m);
    z-index: 9999;
    justify-items: center;
    justify-content: center;
    flex-direction: column;
}
header .header__right #btn-search, header .header__right #btn-toggle-dark{
    display: inline-block;
    padding:  18px 10px;
    height: 25px;
}
header .header__right #btn-dropdown{
  display: inline-block;
  padding:  13.5px 0;
}
header .header__right .dropdown-menus .dropdown-menu {
    padding: 10px;
    color: var(--second-text-color);
}
@media screen and (max-width: 764px){
.navbar__menus {
    display: none!important;
}
.dropdown-icon {
    display: inline-block!important;
}
}
.p-btn{
    position: fixed;
    top: 1rem;
    right: 1rem;
    contain: layout;
}
.toc-btn,.click-btn{
    cursor: pointer;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    align-items: center;
    margin-top: .5rem;
    font-size: .75rem;
    background-color: none;
    display: block;
    padding: 0rem;
    box-shadow: 0 0.3rem 0.6rem rgba(48,55,66,.15);
    border: none;
    border-radius: 0.5rem;
    line-height: 1;
    color: var(--first-text-color);
}
.toc-link{
    color: var(--second-text-color);
}

#css-loading h3{
    font-weight: 500;
    font-size: 1.4rem;
    text-align: center;
    position: fixed;
    top: 200px;
    left: 0;
    right: 0;
    opacity: 0;
    animation: cssLoad;
    animation-delay: 0.3s;
    -webkit-animation: cssLoad;
    -webkit-animation-delay: 0.3s;
}
@keyframes cssLoad {
    from {
        opacity: 0;
    }
    to {
        opacity: 0.9;
    }
}


.memorial {
    -webkit-filter: grayscale(100%);
    -moz-filter: grayscale(100%);
    -ms-filter: grayscale(100%);
    -o-filter: grayscale(100%);
    filter: grayscale(100%);
    filter:progid:DXImageTransform.Microsoft.BasicImage(grayscale=1); filter:gray;
}


    .post-copyright:after {
        position: absolute;
        color: #fff;
        background: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 496 512'%3E%3Cpath fill='gray' d='M245.8 214.9l-33.2 17.3c-9.4-19.6-25.2-20-27.4-20-22.2 0-33.3 14.6-33.3 43.9 0 23.5 9.2 43.8 33.3 43.8 14.4 0 24.6-7 30.5-21.3l30.6 15.5a73.2 73.2 0 01-65.1 39c-22.6 0-74-10.3-74-77 0-58.7 43-77 72.6-77 30.8-.1 52.7 11.9 66 35.8zm143 0l-32.7 17.3c-9.5-19.8-25.7-20-27.9-20-22.1 0-33.2 14.6-33.2 43.9 0 23.5 9.2 43.8 33.2 43.8 14.5 0 24.7-7 30.5-21.3l31 15.5c-2 3.8-21.3 39-65 39-22.7 0-74-9.9-74-77 0-58.7 43-77 72.6-77C354 179 376 191 389 214.8zM247.7 8C104.7 8 0 123 0 256c0 138.4 113.6 248 247.6 248C377.5 504 496 403 496 256 496 118 389.4 8 247.6 8zm.8 450.8c-112.5 0-203.7-93-203.7-202.8 0-105.5 85.5-203.3 203.8-203.3A201.7 201.7 0 01451.3 256c0 121.7-99.7 202.9-202.9 202.9z'/%3E%3C/svg%3E");
        content: ' ';
        height: 10rem;
        width: 10rem;
        right: -2rem;
        top: -2rem;
        opacity: .1;
    }

</style>

    

    
        <!--
        <link rel="stylesheet" href="/css/page.css" media="print"
            onload="this.media='all';this.onload=null">
        <noscript>-->
            <link rel="stylesheet" href="/css/page.css">
        <!--</noscript>-->
    
    
    <link rel="stylesheet" href="/css/main.css" media="print" onload="this.media='all';this.onload=null">
    <noscript>
        <link rel="stylesheet" href="/css/main.css">
    </noscript>

    
    <script src="/js/main.js"></script>
    
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
    <div id="top"></div>
    <div id="page-main" class="main-content">
        <div class="mg-top">
            <div class="post-header">
  <!-- 一款简洁的单栏 Hexo -->
  
    <a href="/">
      <span class="navbar-menu">Home</span>
    </a>
  
    <a href="/archives/">
      <span class="navbar-menu">Archives</span>
    </a>
  
    <a href="/categories/">
      <span class="navbar-menu">Categories</span>
    </a>
  
    <a href="/tags/">
      <span class="navbar-menu">Tags</span>
    </a>
  
</div>

<article class="page">
  <div id="post-meta-m">
    <div class="post-meta" id="post-meta">
  <h3 style="color: rgb(41,177,119);font-family: 'Menlo', 'Meslo LG', monospace">
    FTP 手册
  </h3>
  
    <span class="post-meta-label">
      young
    </span>
  
  
    <span class="post-meta-label">
      <span class="p-dot"></span>
      <time datetime="2023-05-21 18:04" pubdate>
        2023-05-21
      </time>
    </span>
  
  
  
  
</div>
  
  </div>
  <div class="article-m">
    <div class="post-toc">
      
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%A6%82%E5%BF%B5"><span class="toc-text">1. 概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%AE%89%E8%A3%85-ftp"><span class="toc-text">1.1. 安装 ftp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-ftp-sftp-vsftp"><span class="toc-text">1.2. ftp | sftp | vsftp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-PORT%E4%B8%BB%E5%8A%A8%E6%A8%A1%E5%BC%8F-amp-PASV%E8%A2%AB%E5%8A%A8%E6%A8%A1%E5%BC%8F"><span class="toc-text">1.3. PORT主动模式 &amp; PASV被动模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-FTP-%E8%BF%9E%E6%8E%A5%E5%92%8C-HTTP-%E8%BF%9E%E6%8E%A5"><span class="toc-text">1.4. FTP 连接和 HTTP 连接</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%91%BD%E4%BB%A4"><span class="toc-text">2. 命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E7%99%BB%E5%BD%95-FTP"><span class="toc-text">2.1. 登录 FTP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%88%A0%E9%99%A4%E6%8C%87%E5%AE%9A%E7%9A%84%E6%96%87%E4%BB%B6"><span class="toc-text">2.2. 删除指定的文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E5%88%A0%E9%99%A4%E7%9B%AE%E5%BD%95%E4%B8%8B%E5%85%A8%E9%83%A8%E6%96%87%E4%BB%B6"><span class="toc-text">2.3. 删除目录下全部文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E5%88%A0%E9%99%A4%E7%9B%AE%E5%BD%95%E4%B8%8B%E5%A4%9A%E4%B8%AA%E7%AC%A6%E5%90%88%E6%9D%A1%E4%BB%B6%E7%9A%84%E6%96%87%E4%BB%B6"><span class="toc-text">2.4. 删除目录下多个符合条件的文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%91%A8%E8%BE%B9"><span class="toc-text">3. 周边</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-FTP-%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9E%E6%8E%A5%E4%BB%A3%E7%A0%81"><span class="toc-text">3.1. FTP 客户端连接代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%8C%81%E7%BB%AD%E5%BE%80-FTP-%E4%B8%AD%E5%86%99%E6%95%B0%E6%8D%AE"><span class="toc-text">3.2. 多线程持续往 FTP 中写数据</span></a></li></ol></li></ol>
      
    </div>
    <div id="article">
      <div id="post-content" class="markdown-body textretty">
        <h2 id="1-概念"><a href="#1-概念" class="headerlink" title="1. 概念"></a>1. 概念</h2><p>FTP 只通过 TCP 连接，没有用于 FTP 的 UDP 组件。<br>FTP 不同于其他服务的是它使用了两个端口，一个数据端口和一个命令端口(或称为控制端口)。<br>通常 21 端口是命令端口，20 端口是数据端口。</p>
<h3 id="1-1-安装-ftp"><a href="#1-1-安装-ftp" class="headerlink" title="1.1. 安装 ftp"></a>1.1. 安装 ftp</h3><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/7080453850548666376">https://juejin.cn/post/7080453850548666376</a></p>
<h3 id="1-2-ftp-sftp-vsftp"><a href="#1-2-ftp-sftp-vsftp" class="headerlink" title="1.2. ftp | sftp | vsftp"></a>1.2. ftp | sftp | vsftp</h3><p>ftp 是 file transfer protocol 的缩写，文件传输协议，用于在网络上进行文件传输的一套标准协议，使用客户&#x2F;服务器模式。它属于网络传输协议的应用层。<br>sftp 是 secure file transfer protocol 的缩写，安全文件传输协议，是 ssh 服务的一项子服务，所以端口也是 22，用户和密码和 ssh 一致。<br>vsftp 是一个基于 GPL 发布的类 Unix 系统上使用的 ftp 服务器软件，它的全称是 very secure ftp，从此名称可以看出来，编制者的初衷是代码的安全。</p>
<h3 id="1-3-PORT主动模式-amp-PASV被动模式"><a href="#1-3-PORT主动模式-amp-PASV被动模式" class="headerlink" title="1.3. PORT主动模式 &amp; PASV被动模式"></a>1.3. PORT主动模式 &amp; PASV被动模式</h3><p>当混入主动&#x2F;被动模式的概念时，数据端口就有可能不是 20 了。</p>
<p>PORT 主动模式的连接过程是：客户端向服务器的命令端口（默认是21）发送连接请求，服务器接受连接，建立一条命令链路。当需要传送数据时， 客户端在命令链路上用 PORT 命令告诉服务器：我打开了某个端口 A，你过来连接我。于是服务器从 20 端口向客户端的 A 端口发送连接请求，建立一条数据链路来传送数据。   </p>
<p>PASV 被动模式的连接过程是：客户端向服务器的命令端口（默认是21）发送连接请求，服务器接受连接，建立一条命令链路。当需要传送数据时， 服务器在命令链路上用 PASV 命令告诉客户端：我打开了某个端口 B，你过来连接我。于是客户端向服务器的 B 端口发送连接请求，建立一条数据链路来传送数据。<br>当客户端通知服务器它处于被动模式时才启用。</p>
<p>可能产生的问题是，PASV 被动模式下，FTP 服务器每次可能开启不同的端口来传输数据，但是可能由于 Linux 安全限制，例如防火墙，FTP 客户端无法访问这些端口，就无法建立数据链路进行数据传输了。</p>
<p>主动FTP对FTP服务器的管理有利，但对客户端的管理不利。因为FTP服务器企图与客户端的高位随机端口建立连接，而这个端口很有可能被客户端的防火墙阻塞掉。被动FTP对FTP客户端的管理有利，但对服务器端的管理不利。因为客户端要与服务器端建立两个连接，其中一个连到一个高位随机端口，而这个端口很有可能被服务器端的防火墙阻塞掉。<br>幸运的是，有折衷的办法。既然FTP服务器的管理员需要他们的服务器有最多的客户连接，那么必须得支持被动FTP。我们可以通过为FTP服务器指定一个有限的端口范围来减小服务器高位端口的暴露。这样，不在这个范围的任何端口会被服务器的防火墙阻塞。虽然这没有消除所有针对服务器的危险，但它大大减少了危险。</p>
<h3 id="1-4-FTP-连接和-HTTP-连接"><a href="#1-4-FTP-连接和-HTTP-连接" class="headerlink" title="1.4. FTP 连接和 HTTP 连接"></a>1.4. FTP 连接和 HTTP 连接</h3><p>FTP 连接和 HTTP 连接不一样，FTP 连接是要登录验证的。<br>FTP 连接数是有上限的。</p>
<h2 id="2-命令"><a href="#2-命令" class="headerlink" title="2. 命令"></a>2. 命令</h2><h3 id="2-1-登录-FTP"><a href="#2-1-登录-FTP" class="headerlink" title="2.1. 登录 FTP"></a>2.1. 登录 FTP</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sftp username@hostname</span><br></pre></td></tr></table></figure>
<h3 id="2-2-删除指定的文件"><a href="#2-2-删除指定的文件" class="headerlink" title="2.2. 删除指定的文件"></a>2.2. 删除指定的文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">delete filename</span><br><span class="line"></span><br><span class="line">rm -f filename</span><br></pre></td></tr></table></figure>
<h3 id="2-3-删除目录下全部文件"><a href="#2-3-删除目录下全部文件" class="headerlink" title="2.3. 删除目录下全部文件"></a>2.3. 删除目录下全部文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mdelete *</span><br><span class="line"></span><br><span class="line">rm -f *</span><br></pre></td></tr></table></figure>
<h3 id="2-4-删除目录下多个符合条件的文件"><a href="#2-4-删除目录下多个符合条件的文件" class="headerlink" title="2.4. 删除目录下多个符合条件的文件"></a>2.4. 删除目录下多个符合条件的文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mdelete pattern [例如 mdelete *.txt]</span><br><span class="line"></span><br><span class="line">rm -f *.txt</span><br></pre></td></tr></table></figure>
<h2 id="3-周边"><a href="#3-周边" class="headerlink" title="3. 周边"></a>3. 周边</h2><h3 id="3-1-FTP-客户端连接代码"><a href="#3-1-FTP-客户端连接代码" class="headerlink" title="3.1. FTP 客户端连接代码"></a>3.1. FTP 客户端连接代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.net.ftp.FTPClient;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FtpClient</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> FTPClient ftpClient;</span><br><span class="line">  <span class="comment">// ftp_dest格式 ftp://user:password@host:port/path</span></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">FtpClient</span><span class="params">(String ftp_dest)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(ftp_dest);</span><br><span class="line">    <span class="type">String</span> <span class="variable">host</span> <span class="operator">=</span> url.getHost();</span><br><span class="line">    <span class="type">int</span> <span class="variable">port</span> <span class="operator">=</span> url.getPort();</span><br><span class="line">    <span class="type">String</span> <span class="variable">ftpPath</span> <span class="operator">=</span> url.getPath();</span><br><span class="line">    <span class="type">String</span> <span class="variable">userInfo</span> <span class="operator">=</span> url.getUserInfo();</span><br><span class="line">    ftpClient = <span class="keyword">new</span> <span class="title class_">FTPClient</span>();</span><br><span class="line">    ftpClient.connect(host, port);</span><br><span class="line">    ftpClient.login(userInfo.split(<span class="string">&quot;:&quot;</span>)[<span class="number">0</span>], userInfo.split(<span class="string">&quot;:&quot;</span>)[<span class="number">1</span>]);</span><br><span class="line">    ftpClient.changeWorkingDirectory(ftpPath);</span><br><span class="line">    ftpClient.setFileType(FTPClient.BINARY_FILE_TYPE);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 往 ftp 指定路径下写数据.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> store_name 存储数据的文件的名字.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> data 字节数据.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@throws</span> IOException io exception.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeByte</span><span class="params">(String store_name, <span class="type">byte</span>[] data)</span></span><br><span class="line">      <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">OutputStream</span> <span class="variable">ftpFile</span> <span class="operator">=</span> ftpClient.storeFileStream(store_name);</span><br><span class="line">    ftpFile.write(data);</span><br><span class="line">    ftpFile.close();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-2-多线程持续往-FTP-中写数据"><a href="#3-2-多线程持续往-FTP-中写数据" class="headerlink" title="3.2. 多线程持续往 FTP 中写数据"></a>3.2. 多线程持续往 FTP 中写数据</h3><p>用到了生产者-消费者模式，以下是消费者代码。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.net.ftp.FTP;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.net.ftp.FTPClient;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.net.ftp.FTPClientConfig;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.net.ftp.FTPReply;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ArrayBlockingQueue;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestFtp</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span>&#123;</span><br><span class="line">  <span class="keyword">private</span> ArrayBlockingQueue&lt;String&gt; idQueue;</span><br><span class="line">  <span class="keyword">private</span> ArrayBlockingQueue&lt;FTPClient&gt; ftpClients;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">isRunning</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">TestFtp</span><span class="params">(ArrayBlockingQueue&lt;String&gt; idQueue, ArrayBlockingQueue&lt;FTPClient&gt; ftpClients)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.idQueue = idQueue;</span><br><span class="line">    <span class="built_in">this</span>.ftpClients = ftpClients;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (idQueue.size() &gt; <span class="number">0</span> || isRunning) &#123;</span><br><span class="line">      FTPClient ftpClient;</span><br><span class="line">      String filename;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        ftpClient = ftpClients.take();</span><br><span class="line">        filename = idQueue.take();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          OutputStream ftpFile;</span><br><span class="line">          <span class="type">byte</span>[] objFileBytes = Files.readAllBytes(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;/Users/foiunclekay/Desktop/ftp_files/&quot;</span> + filename).toPath());</span><br><span class="line">          <span class="keyword">if</span> (objFileBytes.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            ftpFile = openFile(ftpClient, filename);</span><br><span class="line">            <span class="keyword">if</span> (ftpFile != <span class="literal">null</span>) &#123;</span><br><span class="line">              ftpFile.write(objFileBytes);</span><br><span class="line">              ftpFile.close();</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">        ftpClients.put(ftpClient);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> OutputStream <span class="title function_">openFile</span><span class="params">(FTPClient ftpClient, String filename)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">OutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> ftpClient.storeFileStream(filename);</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> == outputStream) &#123;</span><br><span class="line">      reconnect(ftpClient);</span><br><span class="line">      outputStream = ftpClient.storeFileStream(filename);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> outputStream;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">reconnect</span><span class="params">(FTPClient ftpClient)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      close(ftpClient);</span><br><span class="line">      connect(ftpClient);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;Failed to reconnect.&quot;</span> + e.getMessage());</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(FTPClient ftpClient)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      ftpClient.logout();</span><br><span class="line">      ftpClient.disconnect();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;Error close connection&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">connect</span><span class="params">(FTPClient ftpClient)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;ftp://用户名:密码@主机地址:21/var/ftp/testftp&quot;</span>);</span><br><span class="line">    ftpClient.connect(url.getHost(),url.getPort());</span><br><span class="line">    <span class="type">FTPClientConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FTPClientConfig</span>();</span><br><span class="line">    config.setServerTimeZoneId(<span class="string">&quot;Asia/Shanghai&quot;</span>);</span><br><span class="line">    ftpClient.configure(config);</span><br><span class="line">    ftpClient.login(url.getUserInfo().split(<span class="string">&quot;:&quot;</span>)[<span class="number">0</span>], url.getUserInfo().split(<span class="string">&quot;:&quot;</span>)[<span class="number">1</span>]);</span><br><span class="line">    <span class="type">int</span> <span class="variable">reply</span> <span class="operator">=</span> ftpClient.getReplyCode();</span><br><span class="line">    <span class="keyword">if</span> (!FTPReply.isPositiveCompletion(reply)) &#123;</span><br><span class="line">      ftpClient.disconnect();</span><br><span class="line">      System.out.println(<span class="string">&quot;FTP server refused connection.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ftpClient.enterLocalPassiveMode();</span><br><span class="line">    ftpClient.setFileType(FTP.BINARY_FILE_TYPE);</span><br><span class="line">    <span class="keyword">if</span> (!ftpClient.changeWorkingDirectory(url.getPath())) &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;Create dir:&quot;</span> + url.getPath());</span><br><span class="line">      ftpMakeDirectoryRecursive(ftpClient, url.getPath());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">ftpMakeDirectoryRecursive</span><span class="params">( FTPClient client, String dirTree )</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">dirExists</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">    String[] directories = dirTree.split(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (String dir : directories ) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!dir.isEmpty() ) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dirExists) &#123;</span><br><span class="line">          dirExists = client.changeWorkingDirectory(dir);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!dirExists) &#123;</span><br><span class="line">          <span class="keyword">if</span> (!client.makeDirectory(dir)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IOException</span>(<span class="string">&quot;Unable to create remote directory &#x27;&quot;</span></span><br><span class="line">                + dir + <span class="string">&quot;&#x27;.  error=&#x27;&quot;</span> + client.getReplyString() + <span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (!client.changeWorkingDirectory(dir)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IOException</span>(<span class="string">&quot;Unable to change into newly created remote directory &#x27;&quot;</span></span><br><span class="line">                + dir + <span class="string">&quot;&#x27;.  error=&#x27;&quot;</span> + client.getReplyString() + <span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Stop the thread.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRunning</span><span class="params">(<span class="type">boolean</span> running)</span> &#123;</span><br><span class="line">    isRunning = running;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>生产者代码如下。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.net.ftp.FTP;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.net.ftp.FTPClient;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.net.ftp.FTPClientConfig;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.net.ftp.FTPReply;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ArrayBlockingQueue;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.LinkedBlockingQueue;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ThreadPoolExecutor;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> ThreadPoolExecutor executor= <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">10</span>, <span class="number">15</span>, <span class="number">0L</span>,TimeUnit.MILLISECONDS,</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;&gt;());</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">    ArrayBlockingQueue&lt;String&gt; idQueue = <span class="keyword">new</span> <span class="title class_">ArrayBlockingQueue</span>&lt;&gt;(<span class="number">100</span>);</span><br><span class="line">    <span class="keyword">final</span> List&lt;TestFtp&gt; runners = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(<span class="number">20</span>);</span><br><span class="line">    ArrayBlockingQueue&lt;FTPClient&gt; ftpClients = get();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">      <span class="type">TestFtp</span> <span class="variable">runner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TestFtp</span>(idQueue, ftpClients);</span><br><span class="line">      runners.add(runner);</span><br><span class="line">      executor.execute(runner);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">f</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (f &lt; <span class="number">600</span>) &#123;</span><br><span class="line">      <span class="type">String</span> <span class="variable">objectKey</span> <span class="operator">=</span> f + <span class="string">&quot;.pcap&quot;</span>;</span><br><span class="line">      idQueue.put(objectKey);</span><br><span class="line">      f++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (TestFtp runner : runners) &#123;</span><br><span class="line">      runner.setRunning(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    executor.shutdown();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> ArrayBlockingQueue&lt;FTPClient&gt; <span class="title function_">get</span><span class="params">()</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">    ArrayBlockingQueue&lt;FTPClient&gt; ftpClients = <span class="keyword">new</span> <span class="title class_">ArrayBlockingQueue</span>&lt;&gt;(<span class="number">15</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">dest</span> <span class="operator">=</span> <span class="string">&quot;ftp://用户名:密码@主机地址:21/var/ftp/testftp&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">15</span>; i++) &#123;</span><br><span class="line">      <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(dest);</span><br><span class="line">      <span class="type">FTPClient</span> <span class="variable">ftpClient</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FTPClient</span>();</span><br><span class="line">      ftpClient.connect(url.getHost(),url.getPort());</span><br><span class="line">      <span class="type">FTPClientConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FTPClientConfig</span>();</span><br><span class="line">      config.setServerTimeZoneId(<span class="string">&quot;Asia/Shanghai&quot;</span>);</span><br><span class="line">      ftpClient.configure(config);</span><br><span class="line">      ftpClient.login(url.getUserInfo().split(<span class="string">&quot;:&quot;</span>)[<span class="number">0</span>], url.getUserInfo().split(<span class="string">&quot;:&quot;</span>)[<span class="number">1</span>]);</span><br><span class="line">      <span class="type">int</span> <span class="variable">reply</span> <span class="operator">=</span> ftpClient.getReplyCode();</span><br><span class="line">      <span class="keyword">if</span> (!FTPReply.isPositiveCompletion(reply)) &#123;</span><br><span class="line">        ftpClient.disconnect();</span><br><span class="line">        System.out.println(<span class="string">&quot;FTP server refused connection.&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      ftpClient.enterLocalPassiveMode();</span><br><span class="line">      ftpClient.setFileType(FTP.BINARY_FILE_TYPE);</span><br><span class="line">      ftpClient.changeWorkingDirectory(url.getPath());</span><br><span class="line">      ftpClients.put(ftpClient);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ftpClients;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      </div>
    </div>
  </div>
  
    <div class="post-category">
      <div id="p-meta-i">
        
          
            <a class="hover-with-bg" href="/categories/manuals/">manuals</a>
          
        
        
      </div>
    </div>
  
  <div class="post-footer">
    
    
  </div>
  
</article>


        </div>
        
<footer>
    
    
    
    
    
      <p>
        Copyright &copy;
         
          2023 - 
        
        2023
        Young
      </p>
    
    <!-- <p>Powered by <a href="https://hexo.io" target="_blank">Hexo</a> | Theme by <a href="https://github.com/oCoke/hexo-theme-miracle" target="_blank">Miracle</a></p> -->
</footer>

<div class="p-btn">
    
        <a class="toc-btn" id="toc-btn"><i id="i-menu"></i></a>
        <a href="javascript:window.scrollTo({top:0,behavior:'smooth'});" class="click-btn">
          <i id="i-up"></i>
        </a>
    
    
</div>

<!-- SCRIPTS -->






<script>
    document.getElementById("btn-dropdown").addEventListener('click', () => {
      toggleClass("#dropdown-menus","display-inline");
    });
    console.log('\n' + ' %c Powered by Hexo Theme Miracle ' + ' %c https://github.com/oCoke/hexo-theme-miracle ' + '\n' + '\n', 'color: #fff; background: #4F9BFA; padding:5px 0;', 'background: #FFF; padding:5px 0;');

    

    
  /* 小彩蛋: 饮茶先啦 */
  setTimeout(() => {
    var time = new Date();
    if (time.getHours() == 15) {
      let comment = document.createComment(' 三点几嚟！饮茶先啦！ ');
      document.body.insertBefore(comment, document.getElementsByTagName('header')[0]);
    }
  },1);
    
</script>


<script>
    var postImg = document.querySelectorAll("article[class=page] img");
    for (let imgi = 0; imgi < postImg.length; imgi++) {
        postImg[imgi].onclick = () => {
            let zoomImg = document.createElement("div");
            zoomImg.id = "zoomImg";
            zoomImg.innerHTML = `<div id="zoom-picture"></div>
    <div class="poptrox-overlay"
        style="position: fixed; left: 0px; top: 0px; z-index: 20000; width: 100%; height: 100%; text-align: center; cursor: zoom-out; opacity: 1;">
        <div style="display:inline-block;height:100%;vertical-align:middle;"></div>
        <div
            style="position:absolute;left:0;top:0;width:100%;height:100%;background:#000000;opacity:0;filter:alpha(opacity=0);">
        </div>
        <div class="poptrox-popup"
            style="display: inline-block; vertical-align: middle; position: relative; z-index: 1; cursor: zoom-out; min-width: 10px; min-height: 10px; width: auto; height: auto;">
            <div class="loader" style="display: none;"></div>
            <div class="pic" style="text-indent: 0px;"><img
                    src="${ postImg[imgi].srcset || postImg[imgi].src }" alt="Loading..."
                    style="vertical-align: bottom; max-width: 85vw; max-height: 85vh;"></div>
        </div>
    </div>`;
            document.body.appendChild(zoomImg);
                document.querySelector("#zoomImg").onclick = () => {
                    document.querySelector("#zoomImg").remove();
                }
        }
    }
    
</script>




    <script>
        query("#toc-btn")[0].onclick = () => {
            if (query(".post-toc")[0].innerHTML) {
                toggleClass(".post-toc", "display-inline");
                toggleClass(".post-header", "display-inline");
            }
        }

        if (!query(".post-toc")[0].innerHTML) {
            addClass("#toc-btn","display-none");
        }
    </script>













    </div>
    <div id="css-loading">
        <h3 class="text-center">加载中...</h3>
    </div>
</body>
</html>
